# DeepEAG: A deep learning-based hybrid framework for identifying epilepsy-associated genes using a stacking strategy
===========================================================================


[![license](https://img.shields.io/badge/python_-3.8.0_-blue)](https://www.python.org/)
[![license](https://img.shields.io/badge/torch_-1.12.0_-blue)](https://pytorch.org/)
[![license](https://img.shields.io/badge/scipy_-1.5.0_-blue)](https://scipy.org/)
[![license](https://img.shields.io/badge/xgboost_-1.0.2_-blue)](https://xgboost.readthedocs.io/en/stable/)
[![license](https://img.shields.io/badge/scikit_learn_-1.2.0_-blue)](https://scikit-learn.org/)
[![license](https://img.shields.io/badge/numpy_-1.23.5_-blue)](https://numpy.org/)

As one of the most common neurological diseases in the world, epilepsy can be caused through the deletion or duplication of known epilepsy-associated genes. Therefore, it is crucial to accurately identify epilepsy-associated genes to gain a deeper understanding of the pathogenesis of epilepsy and to develop new therapies. Although a number of wet-lab experimental methods have been proposed, they are reliable but in general time-consuming and labor-intensive. Hence, their practical application in epilepsy-associated genes identification is quite limited. To address the existing limitations, we propose a computational method, called DeepEAG, for the identification of epilepsy-associated genes throughout the human genome. To develop DeepEAG, we first constructed a new and, to our knowledge, the most comprehensive epilepsy genomic benchmark dataset. Afterwards, we investigated four feature encoding algorithms with different perspectives and trained them using well-established traditional classifiers and deep learning classifier, resulting in 13 baseline models. Finally, the stacking strategy is effectively utilized by integrating the predicted output of the optimal baseline models and training with xgboost. In results, the DeepEAG predictor obtained excellent performance on the cross-validation with accuracy and AUC of 0.835 and 0.907, respectively. Overall, DeepEAG showed more stable and accurate predictive performance compared to baseline models, and also outperforms other ensemble strategies, demonstrating the effectiveness of our proposed hybrid framework. In addition, DeepEAG is anticipated to facilitate community-wide efforts to identify putative epilepsy-associated genes and generate new biological insights and testable hypotheses. The schematic diagram of DeepEAG is shown as follows:


![Image text](https://github.com/JfXie/DeepEAG/blob/main/IMG/framework.png)

**(a)** Dataset construction. First, we collected epilepsy-associated genes from recent databases and papers, and obtained their curated sequence from Uniprot database. Second, the CD-HIT tool with 90\% similarity threshold was utilized for redundancy reduction. Third, we checked and removed incorrect amino acid representation for each sequence. Finally, a positive benchmark dataset about epilepsy-associated genes was obtained, which was the largest and most complete one up to date to the best of our knowledge. **(b)** Feature extraction. We investigated four feature encoding algorithms with different perspectives, including sequence-based feature encoding algorithm, physicochemical property-based feature encoding algorithm, evolutionary information-based feature encoding algorithm and one-hot feature encoding algorithm. **(c)** Model training and stacking construction. First, we employed four classifiers and respectively constructed their models based on the different features to predict the score (S1...S10) of the test sample being the epilepsy-associated gene, including deep learning neural network (DNN), adaboost, random forest (RF), and support-vector machine (SVM). Second, the prediction labels generated by the baseline models were concatenated and used as inputs for training the ultimate meta model employing the Xgboost algorithm. **(d)** Performance evaluation. We evaluated the performance of DeepEAG using 5-fold cross-validation method, and visualized the results by the Receiver Operating Characteristic and Precision-Recall curve.

# Table of Contents

- [Installation](#installation)
- [Data description](#data-description)
- [Quick start](#quick-start)
- [Contributing](#contributing)
- [Contacts](#contacts)
- [License](#license)


# Installation

DeepEAG is tested to work under:

```
* Python 3.8.0
* Torch 1.12.0
* Scipy 1.5.0
* Xgboost 1.0.2
* Scikit-learn 1.2.0
* Numpy 1.23.5
* Other basic python toolkits
```
# Data description

| File name  | Description |
| ------------- | ------------- |
| Clinvar_epilepsy_genes.fasta  | Epilepsy-associated genes obtained from ClinVar database and their sequences obtained from Uniprot database|
| DisGeNET_epilepsy_genes.fasta  | Epilepsy-associated genes obtained from DisGeNET database and their sequences obtained from Uniprot database  |
| EpilepsyGeneDatabase_epilepsy_genes.fasta  | Epilepsy-associated genes obtained from EpilepsyGeneDatabase database and their sequences obtained from Uniprot database   |
| Genes4Epilepsy_genes.fasta| Epilepsy-associated genes obtained from Genes4Epilepsy database and their sequences obtained from Uniprot database |
| GWAS_epilepsy_genes.fasta| Epilepsy-associated genes obtained from GWAS database and their sequences obtained from Uniprot database| 
| Uniprot_epilepsy_genes.fasta|  Epilepsy-associated genes and their sequences obtained from Uniprot database| 
| Wang_epilepsy_genes.fasta| Epilepsy-associated genes obtained from Wang et al. and their sequences obtained from Uniprot database| 


# Quick start
To reproduce our results:

## 1，Download uniref dataset and install the required toolkit
```
cd tools/ncbi-blast && wget -c https://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/LATEST/ncbi-blast-2.13.0+-x64-linux.tar.gz && tar -zxvf ncbi-blast-2.13.0+-x64-linux.tar.gz

cd tools/uniref50 && wget -c https://ftp.uniprot.org/pub/databases/uniprot/uniref/uniref50/uniref50.fasta.gz && tar -zxvf uniref50.fasta.gz

/tools/ncbi-blast/ncbi-blast-2.13.0+/bin/makeblastdb -dbtype prot -in uniref50.fasta -input_type fasta -parse_seqids -out uniref50_blast
```



## 2，Run generate_pssm_profile.py to generate pssm profiles for each gene sequence, the options are:
```
python src/generate_pssm_profile.py --file /data/Clinvar_epilepsy_genes.fasta --blastpgp /tools/ncbi-blast/ncbi-blast-2.13.0+/bin --db /tools/uniref50/uniref50_blast --outdir /src/pssm_profile
```
**Arguments**:

| **Arguments** | **Detail** |
| --- | --- |
| **file** | Protein sequence file in fasta format|
| **blastpgp** | The path of NCBI psiblast program|
| **db** | The path of unief50 database|
| **outdir** | The path of output directory|

## 3，Run generate_features/main.py to generate statistical gene sequence patterns for each gene sequence, the options are:
```
python /src/generate_features/main.py --file /data/Clinvar_epilepsy_genes.fasta --type AAC --out /src/AAC_encoding.tsv
python /src/generate_features/main.py --file /data/Clinvar_epilepsy_genes.fasta --type PAAC --out /src/PAAC_encoding.tsv
python /src/generate_features/main.py --file /data/Clinvar_epilepsy_genes.fasta --type PSSMC --path /src/pssm_profiles --out /src/PSSMC_encoding.tsv
python /src/generate_features/main.py --file /data/Clinvar_epilepsy_genes.fasta --type OHE --out /src/OHE_encoding.tsv
```
**Arguments**:

| **Arguments** | **Detail** |
| --- | --- |
| **file** | The input protein sequence file in fasta format. |
| **type** | The encoding type need to be calculated. |
| **path** | The data file path used for 'PSSMC' encodings. |
| **out** | The path of generated descriptor file.  |



## 4，Run DeepEAG_cv/main.py to train and validate model by 5-fold cross-validation, the options are:
```
# please do not change the feature and label file name
python /src/DeepEAG_cv/main.py --feature_path /src --label_path /data
```
**Arguments**:

| **Arguments** | **Detail** |
| --- | --- |
| **feature_path** | The generated feature descriptor file path. |
| **label_path** | The label file path. |






# Contributing

All authors were involved in the conceptualization of the proposed method. DFZ and WL conceived and supervised
the project. JFX and WL designed the study and developed the approach. JFX implemented and applied the method to microbial data. DFZ and WL analyzed the results. DFZ and WL contributed to the review of the manuscript before submission for publication. All authors read and approved the final manuscript.



# Contacts
If you have any questions or comments, please feel free to email: gordon8848@hnu.edu.cn, rj\_wli@hnu.edu.cn.

# License

[MIT Richard McRichface.](../LICENSE)
